import React, { Component } from 'react';import {    View,    Text,    Image,    TextInput,    StyleSheet,    TouchableOpacity,    TouchableWithoutFeedback,    Dimensions} from 'react-native';import Icon from 'react-native-vector-icons/FontAwesome';import { NavigationActions } from 'react-navigation';import AppButton from '../../component/appButton';import memberService from '../../service/memberService';import errorHandle from '../../service/errorHandle';import Spinner from 'react-native-spinner';import { showToast, verification } from '../../utils';import { memberFormStyles } from '../../assets/style';import Header from '../../component/header';const styles = memberFormStyles;export default class SetFundsPassword extends Component {    constructor(props) {        super(props);        this.state = {            isConnecting: false,            foundsPassword: '',            reFoundsPassword: '',            isCanSubmit: false        }        this.submitForm = this.submitForm.bind(this);        this.toggleSpinner = this.toggleSpinner.bind(this);        this.navigate = props.navigation.navigate;        this.goBack = props.navigation.goBack;        this.navigation = props.navigation;    };    toggleSpinner (status) {        this.setState({            isConnecting: status !== undefined ? status : !this.state.isConnecting        });    };    submitForm () {        const data = {fundsPassword: this.state.foundsPassword};        const validate = verification(data);        if (validate === 'success') {            if(this.state.foundsPassword === this.state.reFoundsPassword) {                this.toggleSpinner(true);                memberService.setFundsPassword({password: this.state.foundsPassword})                    .then(res => {                        this.toggleSpinner(false);                        showToast(res.message);                    })                    .then(() => memberService.getUserInfo())                    .then(() => this.goBack())                    .catch(err => {                        this.toggleSpinner(false);                        errorHandle(err).then(res => {                            if(res && res.routeName){                                const resetActions = NavigationActions.reset({                                    index: 0,                                    actions: [NavigationActions.navigate({ routeName: res.routeName})]                                });                                this.props.navigation.dispatch(resetActions);                            }                        })                    })            } else {                showToast('两次输入的密码不一致，请重新输入');            }        }    };    setButtonStatus () {        this.setState({            isCanSubmit: (this.state.foundsPassword && this.state.reFoundsPassword)        })    };    componentWillMount () {    };    render () {        const {foundsPassword, reFoundsPassword, isCanSubmit, isConnecting} = this.state;        return (            <View style={styles.container}>                <Header headerTitle = '设置提现密码'                        navigation = {this.navigation}/>                <View style={styles.inputFile}>                    <Icon iconStyle={styles.inputIcon} width={24} name="lock" size={24} color={'#C9C9C9'}/>                    <TextInput style={styles.inputText}                               placeholder="请输入六位数字的提现密码"                               autoCapitalize={"none"}                               keyboardType={"numeric"}                               value={foundsPassword}                               secureTextEntry={true}                               maxLength={6}                               autoFocus                               underlineColorAndroid='transparent'                               onChangeText={(text) => {                                   this.setState({                                       foundsPassword: text                                   }, () => {                                       this.setButtonStatus()                                   })                               }}/>                </View>                <View style={styles.inputFile}>                    <Icon iconStyle={styles.inputIcon} width={24} name="lock" size={24} color={'#C9C9C9'}/>                    <TextInput style={styles.inputText}                               placeholder="请再次输入提现密码"                               autoCapitalize={"none"}                               keyboardType={"numeric"}                               value={reFoundsPassword}                               secureTextEntry={true}                               underlineColorAndroid='transparent'                               maxLength={6}                               onChangeText={(text) => {                                   this.setState({                                       reFoundsPassword: text                                   }, () => {                                       this.setButtonStatus()                                   })                               }}/>                </View>                <AppButton                    style={styles.appBtn}                    title="确认"                    isDisabled={!isCanSubmit}                    onPressHandle={() => {                        this.submitForm();                    }}                />                <View style={{ flex: 1 }}>                    <Spinner visible={isConnecting}                             color="#333"                             overlayColor="transparent"                             textContent={"正在加载"}                             textStyle={{color: '#333', fontSize: 16}} />                </View>            </View>        )    };    componentWillUnmount () {        if(this.timer){            this.resetCountdown();        }    };}